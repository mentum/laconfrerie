(function(e,t){"use strict";if(typeof define==="function"&&define.amd){define([],t)}else if(typeof exports==="object"){module.exports=t()}else{e.viewportUnitsBuggyfill=t()}})(this,function(){"use strict";function f(e,t){var n;return function(){var r=this;var i=arguments;var s=function(){e.apply(r,i)};clearTimeout(n);n=setTimeout(s,t)}}function l(){try{return window.self!==window.top}catch(e){return true}}function c(r){if(e){return}if(r===true){r={force:true}}t=r||{};t.isMobileSafari=n;if(!t.force&&!n&&!a&&(!t.hacks||!t.hacks.required(t))){return}t.hacks&&t.hacks.initialize(t);e=true;u=document.createElement("style");u.id="patched-viewport";document.head.appendChild(u);w(function(){var e=f(p,t.refreshDebounceWait||100);window.addEventListener("orientationchange",e,true);window.addEventListener("pageshow",e,true);if(t.force||a||l()){window.addEventListener("resize",e,true);t._listeningToResize=true}t.hacks&&t.hacks.initializeEvents(t,p,e);p()})}function h(){u.textContent=m()}function p(){if(!e){return}d();setTimeout(function(){h()},1)}function d(){o=[];i.call(document.styleSheets,function(e){if(e.ownerNode.id==="patched-viewport"||!e.cssRules){return}if(e.media&&e.media.mediaText&&window.matchMedia&&!window.matchMedia(e.media.mediaText).matches){return}i.call(e.cssRules,v)});return o}function v(e){if(e.type===7){var n=e.cssText;r.lastIndex=0;if(r.test(n)){o.push([e,null,n]);t.hacks&&t.hacks.findDeclarations(o,e,null,n)}return}if(!e.style){if(!e.cssRules){return}i.call(e.cssRules,function(e){v(e)});return}i.call(e.style,function(n){var i=e.style.getPropertyValue(n);r.lastIndex=0;if(r.test(i)){o.push([e,n,i]);t.hacks&&t.hacks.findDeclarations(o,e,n,i)}})}function m(){s=b();var e=[];var t=[];var n;var r;o.forEach(function(i){var s=g.apply(null,i);var o=s.selector.length?s.selector.join(" {\n")+" {\n":"";var u=(new Array(s.selector.length+1)).join("\n}");if(!o||o!==n){if(t.length){e.push(n+t.join("\n")+r);t.length=0}if(o){n=o;r=u;t.push(s.content)}else{e.push(s.content);n=null;r=null}return}if(o&&!n){n=o;r=u}t.push(s.content)});if(t.length){e.push(n+t.join("\n")+r)}return e.join("\n\n")}function g(e,n,i){var s=i.replace(r,y);var o=[];if(t.hacks){s=t.hacks.overwriteDeclaration(e,n,s)}if(n){o.push(e.selectorText);s=n+": "+s+";"}var u=e.parentRule;while(u){o.unshift("@media "+u.media.mediaText);u=u.parentRule}return{selector:o,content:s}}function y(e,t,n){var r=s[n];var i=parseFloat(t)/100;return i*r+"px"}function b(){var e=window.innerHeight;var t=window.innerWidth;return{vh:e,vw:t,vmax:Math.max(t,e),vmin:Math.min(t,e)}}function w(e){var t=0;var n=function(){t--;if(!t){e()}};i.call(document.styleSheets,function(e){if(!e.href||E(e.href)===E(location.href)){return}t++;S(e.ownerNode,n)});if(!t){e()}}function E(e){return e.slice(0,e.indexOf("/",e.indexOf("://")+3))}function S(e,t){x(e.href,function(){var n=document.createElement("style");n.media=e.media;n.setAttribute("data-href",e.href);n.textContent=this.responseText;e.parentNode.replaceChild(n,e);t()},t)}function x(e,t,n){var r=new XMLHttpRequest;if("withCredentials"in r){r.open("GET",e,true)}else if(typeof XDomainRequest!=="undefined"){r=new XDomainRequest;r.open("GET",e)}else{throw new Error("cross-domain XHR not supported")}r.onload=t;r.onerror=n;r.send();return r}var e=false;var t;var n=/(iPhone|iPod|iPad).+AppleWebKit/i.test(window.navigator.userAgent);var r=/([+-]?[0-9.]+)(vh|vw|vmin|vmax)/g;var i=[].forEach;var s;var o;var u;var a=false;return{version:"0.4.1",findProperties:d,getCss:m,init:c,refresh:p}})